<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">

  <title>BoothPool</title>

  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootswatch/3.3.5/flatly/bootstrap.min.css">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
  <script type="text/javascript" src="http://maps.google.com/maps/api/js?key=AIzaSyB3eG1Vt6y54OrKrHgpJnZb66QxQvy0kfM&sensor=false"></script>

  <script type="text/javascript">
  var directionDisplay, map;
  var directionsService = new google.maps.DirectionsService();
  var geocoder = new google.maps.Geocoder();

  function initialize() {
    // set the default center of the map
    var latlng = new google.maps.LatLng(41.7891278,-87.5964067);
    // set route options (draggable means you can alter/drag the route in the map)
    var rendererOptions = { draggable: true };
    directionsDisplay = new google.maps.DirectionsRenderer(rendererOptions);
    // set the display options for the map
    var myOptions = {
      zoom: 14,
      center: latlng,
      mapTypeId: google.maps.MapTypeId.ROADMAP,
      mapTypeControl: false
    };
    // add the map to the map placeholder
    map = new google.maps.Map(document.getElementById("map_canvas"),myOptions);
    // bind the map to the directions
    directionsDisplay.setMap(map);
    // start the geolocation API
    if (navigator.geolocation) {
      // when geolocation is available on your device, run this function
      navigator.geolocation.getCurrentPosition(foundYou, notFound);
    } else {
      // when no geolocation is available, alert this message
      alert('Geolocation not supported or not enabled.');
    }
  }

  function notFound(msg) {
    alert('Could not find your location :(')
  }

  function calcRoute() {
    // get the travelmode, startpoint and via point from the form
    var travelMode = $('input[name="travelMode"]:checked').val();
    var start = $("#routeStart").val();
    var end = $("#routeEnd").val();
    // compose a array with options for the directions/route request
    var request = {
      origin: start,
      destination: end,
      unitSystem: google.maps.UnitSystem.IMPERIAL,
      travelMode: google.maps.DirectionsTravelMode[travelMode]
    };
    // call the directions API
    directionsService.route(request, function(response, status) {
      if (status == google.maps.DirectionsStatus.OK) {
        // directions returned by the API, clear the directions panel before adding new directions
        $('#directionsPanel').empty();
        // display the direction details in the container
        directionsDisplay.setDirections(response);
      } else {
        // alert an error message when the route could nog be calculated.
        if (status == 'ZERO_RESULTS') {
          alert('No route could be found between the origin and destination.');
        } else if (status == 'UNKNOWN_ERROR') {
          alert('A directions request could not be processed due to a server error. The request may succeed if you try again.');
        } else if (status == 'REQUEST_DENIED') {
          alert('This webpage is not allowed to use the directions service.');
        } else if (status == 'OVER_QUERY_LIMIT') {
          alert('The webpage has gone over the requests limit in too short a period of time.');
        } else if (status == 'NOT_FOUND') {
          alert('At least one of the origin, destination, or waypoints could not be geocoded.');
        } else if (status == 'INVALID_REQUEST') {
          alert('The DirectionsRequest provided was invalid.');
        } else {
          alert("There was an unknown error in your request. Requeststatus: nn"+status);
        }
      }
    });
  }
  </script>

  <style>
  /* Only necessary if you are using navbar-fixed-top */
  body {
    padding-top: 60px;
  }
  </style>

  <%= stylesheet_link_tag    "application", :media => "all" %>
  <%= javascript_include_tag "application" %>
  <%= csrf_meta_tags %>

  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />



</head>

<body>
  <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
      <!-- Brand and toggle get grouped for better mobile display -->
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a href="/" class="navbar-brand">Booth Pool</a>
      </div>

      <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav">
          <li><a href="/seats">Seats</a></li>
          <li><a href="/comments">Comments</a></li>
          <li><a href="/journeys">Journeys</a></li>
          <li><a href="/rails/info">Sitemap</a></li>
        </ul>

        <ul class="nav navbar-nav navbar-right">
          <% if current_user !=nil  %>

          <li>
            <a href="/users/edit">
              <i class="fa fa-fw fa-user"></i>
              Edit <%= current_user.username %>
            </a>
          </li>

          <li>
            <a href="/users/sign_out" data-method="delete" rel="nofollow">
              <i class="fa fa-fw fa-sign-out"></i>
              Sign Out
            </a>
          </li>
          <% else %>
          <li><a href="/users/sign_up">Sign-up</a></li>
          <li><a href="/users/sign_in">Sign-in</a></li>
          <% end %>

        </ul>
      </div><!-- /.navbar-collapse -->
    </div>
  </nav>

  <div class="container">
    <% if notice.present? %>
    <div class="alert alert-dismissable alert-success">
      <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
      <%= notice %>
    </div>
    <% end %>

    <% if alert.present? %>
    <div class="alert alert-dismissable alert-warning">
      <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
      <%= alert %>
    </div>
    <% end %>

    <%= yield %>
  </div>
</body>
</html>
