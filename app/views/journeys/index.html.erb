<div class="page-header">
  <h1>
    Journeys
    <a href="/journeys/new" class="btn btn-lg btn-success">New Journey</a>
  </h1>
</div>

<div class="row">
  <div class="col-md-12">
    <table class="table table-striped table-hover">

      <tr>
        <th>Date</th>
        <th>Origin</th>
        <th>Destination</th>
        <th>Seats</th>
        <th>Organizer</th>
        <th>Actions</th>
      </tr>

      <% @journeys.each do |journey| %>

      <tr>
        <td class="timestring"><%= journey.date %></td>
        <td><%= journey.origin %></td>
        <td><%= journey.destination %></td>
        <td><%= journey.capacity - journey.seats.count %></td>
        <td><%= journey.organizer.email %></td>
        <td>
          <% if journey.organizer_id == current_user.id %>

          <div class="">
            <div class="btn-group">
              <div class="btn-group">
                <a href="/journeys/<%= journey.id %>" class="btn btn-primary">Show</a>
              </div>

              <div class="btn-group">
                <a href="/journeys/<%= journey.id %>/edit" class="btn btn-warning">Edit</a>
              </div>

              <div class="btn-group">
                <a href="/delete_journey/<%= journey.id %>" class="btn btn-danger" rel="nofollow">Delete</a>
              </div>
            </div>
          </div>

          <% else %>

          <div class="">
            <div class="btn-group">
              <a href="/journeys/<%= journey.id %>" class="btn btn-primary">Show</a>
            </div>

            <div class="btn-group">
              <form action="/create_seat" method="post">
                <!-- Hidden input for authenticity token to protect from forgery -->
                <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
                <!-- Label and input for journey_id -->
                <input type="hidden" name="journey_id" value="<%= journey.id %>">
                <!-- Label and input for user_id -->
                <input type="hidden" name="user_id" value="<%= current_user.id %>">
                <!-- Button for form -->
                <button class="btn btn-success">
                  Join
                </button>
              </form>
            </div>
          </div>

          <% end %>

        </td>
      </tr>
      <% end %>
    </table>
  </div>
</div>
